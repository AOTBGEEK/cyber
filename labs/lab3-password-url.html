<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ูุฎุชุจุฑ 03: ูููุฉ ุงููุฑูุฑ ูู ุงูุฑุงุจุท | ูุฑุดุฉ ูููุฏุณูู ุงููุณุชูุจู</title><link rel="stylesheet" href="../css/styles.css"><link rel="stylesheet" href="../css/animations.css"><link rel="stylesheet" href="../css/labs.css"><link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet"><!-- Arabic Fonts --><link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Tajawal:wght@400;500;700&family=Noto+Sans+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="../css/arabic-fixes.css"><style>
        /* Arabic RTL Support */
        html[lang="ar"] {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] body {
            font-family: 'Cairo', 'Tajawal', 'Noto Sans Arabic', sans-serif !important;
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .message-text,
        html[lang="ar"] .lab-description,
        html[lang="ar"] .slide-body p,
        html[lang="ar"] .hint,
        html[lang="ar"] h1, h2, h3, h4, h5, h6 {
            direction: rtl;
            text-align: right;
            unicode-bidi: embed;
        }
        
        html[lang="ar"] input[type="text"],
        html[lang="ar"] textarea {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .nav-back {
            float: right;
        }
        
        html[lang="ar"] .labs-grid,
        html[lang="ar"] .ai-labs-grid {
            direction: rtl;
        }
        
        html[lang="ar"] .quick-prompts,
        html[lang="ar"] .capability-item,
        html[lang="ar"] .option-group {
            text-align: right;
        }
        
        /* Fix button alignment for RTL */
        html[lang="ar"] .genre-buttons,
        html[lang="ar"] .setting-buttons,
        html[lang="ar"] .style-buttons {
            justify-content: flex-end;
        }
        
        /* Ensure proper Arabic text rendering */
        html[lang="ar"] * {
            font-kerning: auto;
            text-rendering: optimizeLegibility;
            -webkit-font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
            font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
        }
    </style></head><body><div class="lab-grid-bg"></div><!-- Language Toggle --><nav class="lab-nav"><a href="../cyber-home.html" class="nav-back"><span>ุงูุนูุฏุฉ โ</span></a><h1 class="nav-title"><span>ูุฎุชุจุฑ 03: ูููุฉ ุงููุฑูุฑ ูู ุงูุฑุงุจุท</span></h1><div class="lab-timer">00:00:00</div></nav><main class="lab-container"><!-- View Toggle --><div class="view-toggle"><button class="toggle-btn active" onclick="switchView('hacker')"><span class="icon">๐</span><span>ุนุฑุถ ุงููุงูุฑ</span></button><button class="toggle-btn" onclick="switchView('developer')"><span class="icon">๐ก๏ธ</span><span>ุนุฑุถ ุงููุทูุฑ</span></button><button class="toggle-btn" onclick="switchView('quiz')"><span class="icon">๐</span><span>ุงูุฃุณุฆูุฉ</span></button></div><!-- Lab Introduction --><section class="lab-intro"><h2 class="section-header"><span>ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุฑุงุจุท</span></h2><p class="lab-description"><span>ุชูุฑูุฑ ุงููุนูููุงุช ุงูุญุณุงุณุฉ ูุซู ูููุงุช ุงููุฑูุฑ ุฃู ุงูุฑููุฒ ุฃู ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ุนุจุฑ ุงูุฑูุงุจุท ูุฎูู ูุฎุงุทุฑ ุฃูููุฉ ุฎุทูุฑุฉ. 
                ุงูุฑูุงุจุท ูุชู ุชุณุฌูููุง ูุชุฎุฒูููุง ูุคูุชุงู ูุชุธูุฑ ูู ุชุงุฑูุฎ ุงููุชุตูุญุ ููุง ูุฌุนู ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูุนุฑุถุฉ ุจุณูููุฉ.</span></p><div class="threat-level"><span>ูุณุชูู ุงูุชูุฏูุฏ:</span><div class="threat-bar medium"></div><span class="threat-text medium"><span>ูุชูุณุท</span></span></div></section><!-- Hacker View --><section id="hacker-view" class="view-section active"><div class="terminal-header"><span class="terminal-title"><span>ุทุฑููุฉ ุงููุงูุฑ</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="hacker-content"><div class="scenario-box"><h3><span>๐ ุงูุณููุงุฑูู</span></h3><p><span>ููุฏ ุงูุชุดูุช ูููุน ููุจ ููุฑุฑ ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู ูุจุงุดุฑุฉ ูู ุงูุฑุงุจุท ุจุนุฏ ุงููุตุงุฏูุฉ.</span></p><p></span><span>ูุซุงู ุนูู ุงูุฑุงุจุท: <code id="example-url">https://vulnerable-app.com/dashboard?user=admin&pass=SecretP@ss123&token=abc123</code></span></p></div><div class="exploit-steps"><h3><span>๐ ุทุฑู ุงูุงุณุชุบูุงู</span></h3><div class="step"><span class="step-number">01</span><div class="step-content"><h4><span>ุงุณุชุฎุฑุงุฌ ุชุงุฑูุฎ ุงูุฑูุงุจุท</span></h4><button onclick="checkBrowserHistory()" class="cyber-btn"><span>๐ ูุญุต ุชุงุฑูุฎ ุงููุชุตูุญ</span></button><div id="history-results" class="results-box"></div></div></div><div class="step"><span class="step-number">02</span><div class="step-content"><h4><span>ุชุญููู ุณุฌูุงุช ุงูุฎุงุฏู</span></h4><button onclick="analyzeServerLogs()" class="cyber-btn"><span>๐ ุชุญููู ุณุฌูุงุช ุงูุฎุงุฏู</span></button><div id="log-results" class="results-box"></div></div></div><div class="step"><span class="step-number">03</span><div class="step-content"><h4><span>ุงุณุชุบูุงู ุฑุฃุณ ุงููุฑุฌุน</span></h4><button onclick="checkRefererHeaders()" class="cyber-btn"><span>๐ ูุญุต ุฑุคูุณ ุงููุฑุฌุน</span></button><div id="referer-results" class="results-box"></div></div></div><div class="step"><span class="step-number">04</span><div class="step-content"><h4><span>ุงูููุฏุณุฉ ุงูุงุฌุชูุงุนูุฉ</span></h4><div class="social-engineering-demo"><p><span>ุดุงุฑู ูุฐุง ุงูุฑุงุจุท "ุงูุขูู" ูุน ุงูุถุญูุฉ:</span></p><div class="fake-link" id="fake-link">
                                    https://legitimate-site.com/verify?redirect=<span class="highlight">https://vulnerable-app.com/dashboard?user=victim&pass=Exposed123</span></div><button onclick="copyMaliciousLink()" class="cyber-btn small"><span>๐ ูุณุฎ ุงูุฑุงุจุท</span></button></div></div></div></div><div class="url-monitor"><h3><span>๐ด ูุฑุงูุจ ุงูุฑูุงุจุท ุงููุจุงุดุฑ</span></h3><div id="url-monitor-display"></div></div><div class="success-indicator" id="success-indicator"><span class="icon">๐ฏ</span><span>ุชู ุญุตุงุฏ ุจูุงูุงุช ุงูุงุนุชูุงุฏ!</span></div></div></section><!-- Developer View --><section id="developer-view" class="view-section"><div class="terminal-header"><span class="terminal-title"><span>ูุญุฏุฉ ุชุญูู ุงููุทูุฑ</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="developer-content"><div class="vulnerability-explanation"><h3><span>๐ ุชุญููู ุงูุซุบุฑุฉ ุงูุฃูููุฉ</span></h3><p><span>ูููู ูุดู ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุฑูุงุจุท ูู ุฎูุงู ุนุฏุฉ ุทุฑู ูุฌูู:</span></p><ul class="vulnerability-list"><li><span>ุชุงุฑูุฎ ุงููุชุตูุญ ูุงูุฅููุงู ุงูุชููุงุฆู</span></li><li><span>ุณุฌูุงุช ุงููุตูู ููุฎุงุฏู</span></li><li><span>ุณุฌูุงุช ุฎุงุฏู ุงูุจุฑููุณู</span></li><li><span>ุฑุคูุณ ุงููุฑุฌุน ุนูุฏ ุงูุชููู ููููุงูุน ุงูุฎุงุฑุฌูุฉ</span></li><li><span>ุงูุฑูุงุจุท ุงููุดุชุฑูุฉ ุฃู ุงููุญููุธุฉ</span></li><li><span>ุชุณุฌููุงุช ุงูุดุงุดุฉ ุฃู ููุทุงุช ุงูุดุงุดุฉ</span></li></ul><div class="vulnerable-code"><h4><span>โ ููุฏ ุบูุฑ ุขูู</span></h4><pre class="code-block language-javascript">
// ุณูุก: ุชูุฑูุฑ ุจูุงูุงุช ุงูุงุนุชูุงุฏ ูู ุงูุฑุงุจุท
app.get('/login', (req, res) => {
    const { username, password } = req.query;
    
    if (authenticateUser(username, password)) {
        // ุจูุงูุงุช ุงูุงุนุชูุงุฏ ููุดููุฉ ูู ุงูุฑุงุจุท!
        res.redirect(`/dashboard?user=${username}&pass=${password}&token=${generateToken()}`);
    }
});

// ุฌุงูุจ ุงูุนููู - ูุนุฑุถ ููุฎุทุฑ ุฃูุถุงู
function submitLogin() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    
    // ุณูุก: ุจูุงูุงุช ุงูุงุนุชูุงุฏ ูู ุงูุฑุงุจุท
    window.location.href = `/auth?user=${username}&pwd=${password}`;
}</pre></div></div><div class="secure-implementation"><h3><span>๐ก๏ธ ุงูุชูููุฐ ุงูุขูู</span></h3><div class="secure-code"><h4><span>โ ููุฏ ุขูู</span></h4><pre class="code-block language-javascript">
// ุฌูุฏ: ุงุณุชุฎุฏู ุทูุจุงุช POST ูุงูุฌูุณุงุช
app.post('/login', express.json(), async (req, res) => {
    const { username, password } = req.body; // ุงูุฌุณูุ ููุณ ุงูุฑุงุจุท
    
    if (await authenticateUser(username, password)) {
        // ุฅูุดุงุก ุฌูุณุฉ ุขููุฉ
        req.session.userId = user.id;
        req.session.authenticated = true;
        
        // ุชูููุฏ ุฑูุฒ ุขูู
        const token = crypto.randomBytes(32).toString('hex');
        
        // ุญูุธ ุงูุฑูุฒ ุจุดูู ุขูู (ููุณ ูู ุงูุฑุงุจุท)
        await storeSessionToken(user.id, token);
        
        // ุชุนููู ูููู HTTP-only ุขูู
        res.cookie('sessionToken', token, {
            httpOnly: true,
            secure: true, // HTTPS ููุท
            sameSite: 'strict',
            maxAge: 3600000 // ุณุงุนุฉ ูุงุญุฏุฉ
        });
        
        // Redirect without sensitive data
        res.redirect('/dashboard');
    } else {
        res.status(401).json({ error: 'Invalid credentials' });
    }
});

// Client-side - Secure approach
async function submitLogin() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    
    // GOOD: POST request with body
    const response = await fetch('/login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRF-Token': getCsrfToken() // CSRF protection
        },
        body: JSON.stringify({ username, password })
    });
    
    if (response.ok) {
        // Navigate without exposing credentials
        window.location.href = '/dashboard';
    }
}</pre></div><div class="security-best-practices"><h4><span>๐ ุฃูุถู ุงูููุงุฑุณุงุช ุงูุฃูููุฉ</span></h4><div class="practice-grid"><div class="practice-card"><h5><span>ุงุณุชุฎุฏู POST ููุจูุงูุงุช ุงูุญุณุงุณุฉ</span></h5><ul><li><span>ูุง ุชูุฑุฑ ูููุงุช ุงููุฑูุฑ ูู ุทูุจุงุช GET ุฃุจุฏุงู</span></li><li><span>ุงุณุชุฎุฏู ูุต ุงูุทูุจ ูุจูุงูุงุช ุงูุงุนุชูุงุฏ</span></li><li><span>ุทุจู HTTPS ุจุดูู ุตุญูุญ</span></li></ul></div><div class="practice-card"><h5><span>ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช</span></h5><ul><li><span>ุงุณุชุฎุฏู ุฑููุฒ ุฌูุณุงุช ุขููุฉ</span></li><li><span>ุฎุฒู ูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท HTTP-only</span></li><li><span>ุทุจู ุงูุชูุงุก ุตูุงุญูุฉ ุงูุฌูุณุฉ</span></li></ul></div><div class="practice-card"><h5><span>ุฃูุงู ุงูุฑููุฒ</span></h5><ul><li><span>ุงุณุชุฎุฏู ุฑููุฒ ุขููุฉ ุชุดููุฑูุงู</span></li><li><span>ุทุจู ุฏูุฑุงู ุงูุฑููุฒ</span></li><li><span>ูุง ุชูุดููุง ูู ุงูุฑูุงุจุท ุฃู ุงูุณุฌูุงุช ุฃุจุฏุงู</span></li></ul></div><div class="practice-card"><h5><span>ููุงุฑุณุงุช ุงูุชุณุฌูู</span></h5><ul><li><span>ูุธู ุงูุฑูุงุจุท ูุจู ุงูุชุณุฌูู</span></li><li><span>ูุง ุชุณุฌู ูููุงุช ุงููุฑูุฑ ุฃู ุงูุฑููุฒ ุฃุจุฏุงู</span></li><li><span>ุทุจู ุณูุงุณุงุช ุงูุงุญุชูุงุธ ุจุงูุณุฌูุงุช</span></li></ul></div></div></div></div><div class="additional-protections"><h3><span>๐ก ุญูุงูุฉ ุฅุถุงููุฉ</span></h3><div class="protection-list"><div class="protection-item"><span class="icon">๐</span><strong><span>ุชุตููุฉ ูุนุงููุงุช ุงูุฑุงุจุท:</span></strong><p><span>ุทุจู ูุณุทุงุก ูููุดู ุนู ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุฑูุงุจุท ูุญุฌุจูุง</span></p></div><div class="protection-item"><span class="icon">๐</span><strong><span>ุฑุคูุณ ุงูุฃูุงู:</span></strong><p><span>ุงุณุชุฎุฏู ุฑุฃุณ Referrer-Policy ููุชุญูู ูู ุงููุนูููุงุช ุงููุฑุณูุฉ</span></p><code>Referrer-Policy: no-referrer</code></div><div class="protection-item"><span class="icon">๐</span><strong><span>ูุฑุงุฌุนุฉ ุงูููุฏ:</span></strong><p><span>ูุณุญ ุชููุงุฆู ููุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุฑูุงุจุท ุฃุซูุงุก CI/CD</span></p></div><div class="protection-item"><span class="icon">๐</span><strong><span>ุงููุฑุงูุจุฉ:</span></strong><p><span>ุชูุจูู ุนูู ุงูุฑูุงุจุท ุงูุชู ุชุญุชูู ุนูู ุฃููุงุท ูุซู 'pass='ุ 'token='ุ 'key='</span></p></div></div></div></div></section><!-- Quiz View --><section id="quiz-view" class="view-section" style="display: none;"><div class="terminal-header"><span class="terminal-title"><span>ุงุฎุชุจุงุฑ ุงููุนุฑูุฉ</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="quiz-content"><div class="quiz-intro"><h3><span>๐ ุงุฎุชุจุฑ ูุนุฑูุชู</span></h3><p><span>ุฃุฌุจ ุนูู ุงูุฃุณุฆูุฉ ุงูุชุงููุฉ ูุงุฎุชุจุงุฑ ูููู ููุฎุงุทุฑ ุชูุฑูุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุฑูุงุจุท ูุทุฑู ุงูุญูุงูุฉ ูููุง.</span></p></div><div class="quiz-questions" id="quiz-questions"><div class="question-card" data-question="1"><h4><span>ุงูุณุคุงู 1: ููุงุฐุง ููุนุชุจุฑ ุชูุฑูุฑ ูููุงุช ุงููุฑูุฑ ูู ุงูุฑุงุจุท ุฎุทุฑุงู ุฃูููุงูุ</span></h4><div class="options"><label class="option"><input type="radio" name="q1" value="a"><span>ูุฃููุง ุชุฌุนู ุงููููุน ุฃุจุทุฃ</span></label><label class="option"><input type="radio" name="q1" value="b"><span>ูุฃู ุงูุฑูุงุจุท ุชูุณุฌู ูู ุชุงุฑูุฎ ุงููุชุตูุญ ูุณุฌูุงุช ุงูุฎุงุฏู</span></label><label class="option"><input type="radio" name="q1" value="c"><span>ูุฃููุง ุชุณุชููู ูุณุงุญุฉ ุฃูุจุฑ</span></label><label class="option"><input type="radio" name="q1" value="d"><span>ูุฃููุง ุชุชุทูุจ ุชุดููุฑ ุฅุถุงูู</span></label></div></div><div class="question-card" data-question="2"><h4><span>ุงูุณุคุงู 2: ุฃู ูู ูุฐู ุงูุทุฑู ุขููุฉ ูุฅุฑุณุงู ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎููุ</span></h4><div class="options"><label class="option"><input type="radio" name="q2" value="a"><span>GET request ูุน ุงูุฑุงุจุท</span></label><label class="option"><input type="radio" name="q2" value="b"><span>POST request ูุน ูุต ุงูุทูุจ</span></label><label class="option"><input type="radio" name="q2" value="c"><span>ุฅุฑุณุงููุง ูู ุนููุงู ุงูุตูุญุฉ</span></label><label class="option"><input type="radio" name="q2" value="d"><span>ุญูุธูุง ูู Local Storage</span></label></div></div><div class="question-card" data-question="3"><h4><span>ุงูุณุคุงู 3: ูุง ูู ุงูููุงู ุงูุตุญูุญ ูุญูุธ ุฑููุฒ ุงูุฌูุณุฉ ุงูุขููุฉุ</span></h4><div class="options"><label class="option"><input type="radio" name="q3" value="a"><span>ูู ุฑุงุจุท ุงูุตูุญุฉ</span></label><label class="option"><input type="radio" name="q3" value="b"><span>ูู HTTP-only cookies</span></label><label class="option"><input type="radio" name="q3" value="c"><span>ูู JavaScript variables</span></label><label class="option"><input type="radio" name="q3" value="d"><span>ูู ุนููุงู ุงูุตูุญุฉ</span></label></div></div><div class="question-card" data-question="4"><h4><span>ุงูุณุคุงู 4: ููู ูููู ููููุงุฌู ุงุณุชุบูุงู ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุฑูุงุจุทุ</span></h4><div class="options"><label class="option"><input type="radio" name="q4" value="a"><span>ููุท ูู ุฎูุงู ูุญุต ุงูููุฏ ุงููุตุฏุฑู</span></label><label class="option"><input type="radio" name="q4" value="b"><span>ูู ุฎูุงู ุชุงุฑูุฎ ุงููุชุตูุญ ูุฑุคูุณ ุงููุฑุฌุน ูุณุฌูุงุช ุงูุฎุงุฏู</span></label><label class="option"><input type="radio" name="q4" value="c"><span>ููุท ุนูุฏ ูุดุงุฑูุฉ ุงูุฑูุงุจุท</span></label><label class="option"><input type="radio" name="q4" value="d"><span>ูุง ูููู ุงุณุชุบูุงููุง ุฃุจุฏุงู</span></label></div></div><div class="question-card" data-question="5"><h4><span>ุงูุณุคุงู 5: ูุง ูู ุฃูุถู ุฑุฃุณ HTTP ููุชุญูู ูู ุงููุนูููุงุช ุงููุฑุณูุฉ ูู ุงููุฑุฌุนุ</span></h4><div class="options"><label class="option"><input type="radio" name="q5" value="a"><span>Content-Security-Policy</span></label><label class="option"><input type="radio" name="q5" value="b"><span>Referrer-Policy</span></label><label class="option"><input type="radio" name="q5" value="c"><span>X-Frame-Options</span></label><label class="option"><input type="radio" name="q5" value="d"><span>Strict-Transport-Security</span></label></div></div></div><div class="quiz-controls"><button onclick="checkAnswers()" class="cyber-btn large"><span>โ ุชุญูู ูู ุงูุฅุฌุงุจุงุช</span></button><button onclick="resetQuiz()" class="cyber-btn secondary"><span>๐ ุฅุนุงุฏุฉ ุงููุญุงููุฉ</span></button></div><div class="quiz-results" id="quiz-results"><div class="result-summary"><h3><span>ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ</span></h3><div class="score-display"><span class="score-text">ุงููุชูุฌุฉ: </span><span class="score-value" id="quiz-score">0/5</span></div><div class="result-message" id="result-message"></div></div><div class="answer-review" id="answer-review"></div></div></div></section><!-- Lab Progress --><div class="lab-progress"><div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div><div class="progress-steps"><div class="step-indicator active"><span>ุงูุชุดุงู</span></div><div class="step-indicator"><span>ุงุณุชุบูุงู</span></div><div class="step-indicator"><span>ุงุณุชุฎุฑุงุฌ</span></div><div class="step-indicator"><span>ุฏูุงุน</span></div></div></div></main><script src="../js/lab-common.js"></script><script src="../js/lab3-password-url.js"></script></body></html> 