<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ูุฎุชุจุฑ 01: IDOR - ุชุบููุฑ ุงูุฃุฏูุงุฑ | ูุฑุดุฉ ูููุฏุณูู ุงููุณุชูุจู</title><link rel="stylesheet" href="../css/styles.css"><link rel="stylesheet" href="../css/animations.css"><link rel="stylesheet" href="../css/labs.css"><link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet"><!-- Arabic Fonts --><link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Tajawal:wght@400;500;700&family=Noto+Sans+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="../css/arabic-fixes.css"><style>
        /* Arabic RTL Support */
        html[lang="ar"] {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] body {
            font-family: 'Cairo', 'Tajawal', 'Noto Sans Arabic', sans-serif !important;
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .message-text,
        html[lang="ar"] .lab-description,
        html[lang="ar"] .slide-body p,
        html[lang="ar"] .hint,
        html[lang="ar"] h1, h2, h3, h4, h5, h6 {
            direction: rtl;
            text-align: right;
            unicode-bidi: embed;
        }
        
        html[lang="ar"] input[type="text"],
        html[lang="ar"] textarea {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .nav-back {
            float: right;
        }
        
        html[lang="ar"] .labs-grid,
        html[lang="ar"] .ai-labs-grid {
            direction: rtl;
        }
        
        html[lang="ar"] .quick-prompts,
        html[lang="ar"] .capability-item,
        html[lang="ar"] .option-group {
            text-align: right;
        }
        
        /* Fix button alignment for RTL */
        html[lang="ar"] .genre-buttons,
        html[lang="ar"] .setting-buttons,
        html[lang="ar"] .style-buttons {
            justify-content: flex-end;
        }
        
        /* Ensure proper Arabic text rendering */
        html[lang="ar"] * {
            font-kerning: auto;
            text-rendering: optimizeLegibility;
            -webkit-font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
            font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
        }
    </style></head><body><div class="lab-grid-bg"></div><div class="cyber-particles"></div><!-- Language Toggle --><nav class="lab-nav"><a href="../cyber-home.html" class="nav-back"><span>ุงูุนูุฏุฉ ูููุฎุชุจุฑุงุช โ</span></a><h1 class="nav-title"><span>ูุฎุชุจุฑ 01: <span class="english-term">IDOR</span> - ุชุบููุฑ ุงูุฃุฏูุงุฑ</span></h1><div class="lab-timer">00:00:00</div></nav><main class="lab-container"><!-- View Toggle --><div class="view-toggle"><button class="toggle-btn active" onclick="switchView('hacker')"><span class="icon">๐</span><span>ุนุฑุถ ุงููุงูุฑ</span></button><button class="toggle-btn" onclick="switchView('developer')"><span class="icon">๐ก๏ธ</span><span>ุนุฑุถ ุงููุทูุฑ</span></button></div><!-- Lab Introduction --><section class="lab-intro"><h2 class="section-header"><span>ุงููุฑุฌุน ุงููุจุงุดุฑ ุบูุฑ ุงูุขูู ูููุงุฆู (<span class="english-term">IDOR</span>)</span></h2><p class="lab-description"><span>ุชุญุฏุซ ุซุบุฑุงุช <span class="english-term">IDOR</span> ุนูุฏูุง ููุดู ุงูุชุทุจูู ูุฑุงุฌุน ูุจุงุดุฑุฉ ูููุงุฆูุงุช ุงูุฏุงุฎููุฉ 
                ูุซู ููุงุชูุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃู ุฃุณูุงุก ุงููููุงุช. ูููู ููููุงุฌููู ุงูุชูุงุนุจ ุจูุฐู ุงููุฑุงุฌุน ูููุตูู ุฅูู ุจูุงูุงุช ุบูุฑ ูุตุฑุญ ุจูุง.</span></p><div class="threat-level"><span>ูุณุชูู ุงูุชูุฏูุฏ:</span><div class="threat-bar high"></div><span class="threat-text"><span>ุนุงูู</span></span></div></section><!-- Hacker View --><section id="hacker-view" class="view-section active"><div class="terminal-header"><span class="terminal-title"><span>ุทุฑููุฉ ุงููุงูุฑ</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="hacker-content"><div class="scenario-box"><h3><span>๐ ุงูุณููุงุฑูู</span></h3><p></span><span>ููุฏ ุงูุชุดูุช ุชุทุจูู ููุจ ูุณุชุฎุฏู ูุนุฑูุงุช ูุณุชุฎุฏููู ูุงุจูุฉ ููุชูุจุค ูู ุงูุฑุงุจุท. 
                        ุงูุฑุงุจุท ุงูุญุงูู ูุธูุฑ: <code><span class="english-term">https://app.example.com/profile?user_id=1001</span></code></span></p><p><span>ูููุชู: ุงุณุชุบูุงู ูุฐู ุงูุซุบุฑุฉ ูููุตูู ุฅูู ุตูุงุญูุงุช ุงููุฏูุฑ.</span></p></div><div class="exploit-steps"><h3><span>๐ ุฎุทูุงุช ุงูุงุณุชุบูุงู</span></h3><div class="step"><span class="step-number">01</span><div class="step-content"><h4><span>ุชุญุฏูุฏ ุงูููุท</span></h4><div class="code-block"><pre><span class="english-term">// ุงูุฑุงุจุท ุงูุญุงูู
https://app.example.com/profile?user_id=1001
                                
// ุฌุฑุจ ูุนุฑูุงุช ูุฎุชููุฉ
user_id=1000  // ุฑุจูุง ุงููุฏูุฑุ
user_id=1     // ุงููุณุชุฎุฏู ุงูุฃููุ
user_id=0     // ูุณุชุฎุฏู ุงููุธุงูุ</span></pre></div></div></div><div class="step"><span class="step-number">02</span><div class="step-content"><h4><span>ุชุนุฏุงุฏ ุฃุฏูุงุฑ ุงููุณุชุฎุฏููู</span></h4><div class="interactive-demo"><input type="text" id="user-id-input" placeholder="" value="1001"><button onclick="tryUserID()" class="cyber-btn"><span>ุชูููุฐ</span></button><div id="response-display" class="response-area"><pre><span>ูู ุงูุชุธุงุฑ ุงูุฅุฏุฎุงู...</span></pre></div></div></div></div><div class="step"><span class="step-number">03</span><div class="step-content"><h4><span>ุชุตุนูุฏ ุงูุตูุงุญูุงุช</span></h4><p><span>ุจูุฌุฑุฏ ุงูุนุซูุฑ ุนูู ูุนุฑู ุงููุฏูุฑุ ููููู ุงููุตูู ุฅูู ุงููุธุงุฆู ุงูุฅุฏุงุฑูุฉ!</span></p><div class="success-indicator" id="success-indicator"><span class="icon">๐ฏ</span><span>ุชู ุงุฎุชุฑุงู ุงููุฏู</span></div></div></div></div><div class="attack-visualization"><canvas id="attack-canvas"></canvas></div></div></section><!-- Developer View --><section id="developer-view" class="view-section"><div class="terminal-header"><span class="terminal-title"><span>ูุญุฏุฉ ุชุญูู ุงููุทูุฑ</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="developer-content"><div class="vulnerability-explanation"><h3><span>๐ ุชุญููู ุงูุซุบุฑุฉ</span></h3><p><span>ูุณุชุฎุฏู ุงูุชุทุจูู ูุจุงุดุฑุฉ ุงููุฏุฎูุงุช ุงูุชู ูุชุญูู ูููุง ุงููุณุชุฎุฏู ูููุตูู ุฅูู ูููุงุช ุชุนุฑูู ุงููุณุชุฎุฏููู ุจุฏูู ูุญูุตุงุช ุชุฎููู ููุงุณุจุฉ.</span></p><div class="vulnerable-code"><h4><span>โ ููุฏ ูุนุฑุถ ููุฎุทุฑ</span></h4><pre class="code-block language-javascript">
<span class="english-term">// ุณูุก: ูุฑุฌุน ูุจุงุดุฑ ูููุงุฆู ุจุฏูู ุชุฎููู
app.get('/profile', (req, res) => {
    const userId = req.query.user_id;
    
    // ุฌูุจ ุงููุณุชุฎุฏู ูุจุงุดุฑุฉ ุจุฏูู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
    const user = db.getUser(userId);
    res.json(user);
});</span></pre></div></div><div class="secure-implementation"><h3><span>๐ก๏ธ ุงูุชูููุฐ ุงูุขูู</span></h3><div class="secure-code"><h4><span>โ ููุฏ ููุตุญุญ</span></h4><pre class="code-block language-javascript">
<span class="english-term">// ุฌูุฏ: ูุญุต ุชุฎููู ููุงุณุจ
app.get('/profile', authenticate, (req, res) => {
    const requestedUserId = req.query.user_id;
    const currentUserId = req.user.id;
    
    // ุงูุชุญูู ูู ุฅููุงููุฉ ูุตูู ุงููุณุชุฎุฏู ููุฐุง ุงูููู ุงูุดุฎุตู
    if (requestedUserId !== currentUserId && !req.user.isAdmin) {
        return res.status(403).json({ 
            error: 'Unauthorized access' 
        });
    }
    
    const user = db.getUser(requestedUserId);
    res.json(user);
});

// ุฅุฌุฑุงุกุงุช ุฃูุงู ุฅุถุงููุฉ
function authenticate(req, res, next) {
    const token = req.headers.authorization;
    
    if (!token) {
        return res.status(401).json({ 
            error: 'Authentication required' 
        });
    }
    
    try {
        const decoded = jwt.verify(token, process.env.JWT_SECRET);
        req.user = decoded;
        next();
    } catch (error) {
        return res.status(401).json({ 
            error: 'Invalid token' 
        });
    }
}</span></pre></div><div class="security-checklist"><h4><span>๐ ูุงุฆูุฉ ุงูุฃูุงู</span></h4><ul><li class="checklist-item"><span class="check">โ</span><span>ุชูููุฐ ูุตุงุฏูุฉ ููุงุณุจุฉ</span></li><li class="checklist-item"><span class="check">โ</span><span>ุงูุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู ููู ุทูุจ</span></li><li class="checklist-item"><span class="check">โ</span><span>ุงุณุชุฎุฏุงู ูุฑุงุฌุน ูุงุฆูุงุช ุบูุฑ ูุจุงุดุฑุฉ (UUIDsุ tokens)</span></li><li class="checklist-item"><span class="check">โ</span><span>ุชุณุฌูู ูุญุงููุงุช ุงููุตูู ููุฑุงูุจุฉ ุงูุฃูุงู</span></li><li class="checklist-item"><span class="check">โ</span><span>ุชูููุฐ ุชุญุฏูุฏ ุงููุนุฏู ูููุน ุงูุชุนุฏุงุฏ</span></li></ul></div></div><div class="best-practices"><h3><span>๐ก ุฃูุถู ุงูููุงุฑุณุงุช</span></h3><div class="practice-grid"><div class="practice-card"><h4><span>ุงุณุชุฎุฏุงู UUIDs</span></h4><p><span>ุงุณุชุจุฏุงู ุงููุนุฑูุงุช ุงููุชุณูุณูุฉ ุจู UUIDs ูููุน ุงูุชุนุฏุงุฏ</span></p><code><span class="english-term">user_id=550e8400-e29b-41d4-a716-446655440000</span></code></div><div class="practice-card"><h4><span>ุงููุตูู ุงููุงุฆู ุนูู ุงูุฌูุณุฉ</span></h4><p><span>ุงุณุชุฎุฏุงู ุฑููุฒ ุงูุฌูุณุฉ ุจุฏูุงู ูู ุงููุนุฑูุงุช ุงููุจุงุดุฑุฉ</span></p><code><span class="english-term">/profile/me</span></code></div><div class="practice-card"><h4><span>ููุงุฆู ุงูุชุญูู ูู ุงููุตูู</span></h4><p><span>ุชูููุฐ ุตูุงุญูุงุช ุฏูููุฉ ุงูุชูุตูู</span></p><code><span class="english-term">canRead(), canWrite(), canDelete()</span></code></div></div></div></div></section><!-- Lab Progress --><div class="lab-progress"><div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div><div class="progress-steps"><div class="step-indicator active"><span>ุชุญุฏูุฏ</span></div><div class="step-indicator"><span>ุงุณุชุบูุงู</span></div><div class="step-indicator"><span>ุฏูุงุน</span></div><div class="step-indicator"><span>ููุชูู</span></div></div></div></main><script src="../js/lab-common.js"></script><script src="../js/lab1-idor.js"></script></body></html> 