<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ูุฎุชุจุฑ 02: ูุฌูู ุงูููุฉ ุงูุบุงุดูุฉ | ูุฑุดุฉ ูููุฏุณูู ุงููุณุชูุจู</title><link rel="stylesheet" href="../css/styles.css"><link rel="stylesheet" href="../css/animations.css"><link rel="stylesheet" href="../css/labs.css"><link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet"><!-- Arabic Fonts --><link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Tajawal:wght@400;500;700&family=Noto+Sans+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="../css/arabic-fixes.css"><style>
        /* Arabic RTL Support */
        html[lang="ar"] {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] body {
            font-family: 'Cairo', 'Tajawal', 'Noto Sans Arabic', sans-serif !important;
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .message-text,
        html[lang="ar"] .lab-description,
        html[lang="ar"] .slide-body p,
        html[lang="ar"] .hint,
        html[lang="ar"] h1, h2, h3, h4, h5, h6 {
            direction: rtl;
            text-align: right;
            unicode-bidi: embed;
        }
        
        html[lang="ar"] input[type="text"],
        html[lang="ar"] textarea {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .nav-back {
            float: right;
        }
        
        html[lang="ar"] .labs-grid,
        html[lang="ar"] .ai-labs-grid {
            direction: rtl;
        }
        
        html[lang="ar"] .quick-prompts,
        html[lang="ar"] .capability-item,
        html[lang="ar"] .option-group {
            text-align: right;
        }
        
        /* Fix button alignment for RTL */
        html[lang="ar"] .genre-buttons,
        html[lang="ar"] .setting-buttons,
        html[lang="ar"] .style-buttons {
            justify-content: flex-end;
        }
        
        /* Ensure proper Arabic text rendering */
        html[lang="ar"] * {
            font-kerning: auto;
            text-rendering: optimizeLegibility;
            -webkit-font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
            font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
        }
    </style></head><body><div class="lab-grid-bg"></div><div class="cyber-particles"></div><!-- Language Toggle --><nav class="lab-nav"><a href="../cyber-home.html" class="nav-back"><span>ุงูุนูุฏุฉ ูููุฎุชุจุฑุงุช โ</span></a><h1 class="nav-title"><span>ูุฎุชุจุฑ 02: ูุฌูู ุงูููุฉ ุงูุบุงุดูุฉ</span></h1><div class="lab-timer">00:00:00</div></nav><main class="lab-container"><!-- View Toggle --><div class="view-toggle"><button class="toggle-btn active" onclick="switchView('hacker')"><span class="icon">๐</span><span>ุนุฑุถ ุงููุงูุฑ</span></button><button class="toggle-btn" onclick="switchView('developer')"><span class="icon">๐ก๏ธ</span><span>ุนุฑุถ ุงููุทูุฑ</span></button></div><!-- Lab Introduction --><section class="lab-intro"><h2 class="section-header"><span>ูุฌูู ุงูููุฉ ุงูุบุงุดูุฉ</span></h2><p class="lab-description"><span>ุชุฌุฑุจ ูุฌูุงุช ุงูููุฉ ุงูุบุงุดูุฉ ุจุดูู ูููุฌู ุฌููุน ุชุฑููุจุงุช ูููุงุช ุงููุฑูุฑ ุงูููููุฉ ุญุชู ุงูุนุซูุฑ ุนูู ุงูุตุญูุญุฉ. 
                ููุถุญ ูุฐุง ุงููุฎุชุจุฑ ุชูููุงุช ูุณุฑ ูููุงุช ุงููุฑูุฑ ูุขููุงุช ุงูุฏูุงุน.</span></p><div class="threat-level"><span>ูุณุชูู ุงูุชูุฏูุฏ:</span><div class="threat-bar high"></div><span class="threat-text"><span>ุนุงูู</span></span></div></section><!-- Hacker View --><section id="hacker-view" class="view-section active"><div class="terminal-header"><span class="terminal-title"><span>ุทุฑููุฉ ุงููุงูุฑ</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="hacker-content"><div class="scenario-box"><h3><span>๐ ุงูุณููุงุฑูู</span></h3><p><span>ููุฏ ุงูุชุดูุช ูููุฐุฌ ุชุณุฌูู ุฏุฎูู ุจุฏูู ุชุญุฏูุฏ ูุนุฏู ุฃู ููู ุงูุญุณุงุจ. 
                        ุงููุฏู ูุณุชุฎุฏู ูููุงุช ูุฑูุฑ ุถุนููุฉ. ุญุงู ุงูููุช ูุฅุทูุงู ูุฌูู ุงูููุฉ ุงูุบุงุดูุฉ!</span></p><p></span><span>ุงุณู ุงููุณุชุฎุฏู ุงููุณุชูุฏู: <code>admin@company.com</code></span></p></div><div class="exploit-steps"><h3><span>๐จ ูุฌูู ุงูููุฉ ุงูุบุงุดูุฉ</span></h3><div class="step"><span class="step-number">01</span><div class="step-content"><h4><span>ุงุฎุชุฑ ุทุฑููุฉ ุงููุฌูู</span></h4><div class="attack-options"><button class="attack-btn" onclick="selectAttack('dictionary')"><span>๐ ูุฌูู ุงููุงููุณ</span></button><button class="attack-btn" onclick="selectAttack('common')"><span>๐ค ูููุงุช ุงููุฑูุฑ ุงูุดุงุฆุนุฉ</span></button><button class="attack-btn" onclick="selectAttack('pattern')"><span>๐ฏ ุงููุงุฆู ุนูู ุงูุฃููุงุท</span></button></div></div></div><div class="step"><span class="step-number">02</span><div class="step-content"><h4><span>ุฅุทูุงู ุงููุฌูู</span></h4><div class="brute-force-interface"><button onclick="startBruteForce()" class="cyber-btn large"><span>โก ุจุฏุก ุงููุฌูู</span></button><div class="attack-stats"><div class="stat"><span class="label"><span>ุงููุญุงููุงุช:</span></span><span id="attempt-count">0</span></div><div class="stat"><span class="label"><span>ุงูุณุฑุนุฉ:</span></span><span id="attack-speed">0</span>/sec
                                    </div><div class="stat"><span class="label"><span>ุงูููุช:</span></span><span id="attack-time">00:00</span></div></div></div></div></div><div class="step"><span class="step-number">03</span><div class="step-content"><h4><span>ุชูุฏู ุงููุฌูู</span></h4><div class="password-attempts" id="password-attempts"><div class="attempts-header"><span>ุฌุงุฑู ุชุฌุฑุจุฉ ูููุงุช ุงููุฑูุฑ...</span></div><div class="attempts-list" id="attempts-list"></div></div><div class="success-indicator" id="success-indicator"><span class="icon">๐ฏ</span><span>ุชู ูุณุฑ ูููุฉ ุงููุฑูุฑ: <span id="cracked-password"></span></span></span></div></div></div></div><div class="attack-visualization"><canvas id="brute-force-canvas"></canvas></div></div></section><!-- Developer View --><section id="developer-view" class="view-section"><div class="terminal-header"><span class="terminal-title"><span>ูุญุฏุฉ ุชุญูู ุงููุทูุฑ</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="developer-content"><div class="vulnerability-explanation"><h3><span>๐ ุชุญููู ุงูุซุบุฑุฉ ุงูุฃูููุฉ</span></h3><p><span>ููุชูุฑ ุงูุชุทุจูู ุฅูู ุงูุฏูุงุนุงุช ุงูููุงุณุจุฉ ุถุฏ ูุฌูุงุช ุชุฎููู ูููุงุช ุงููุฑูุฑ ุงูุขููุฉ.</span></p><div class="vulnerable-code"><h4><span>โ ููุฏ ูุนุฑุถ ููุฎุทุฑ</span></h4><pre class="code-block language-javascript">
// ุณูุก: ูุง ุชูุฌุฏ ุญูุงูุฉ ุถุฏ ูุฌูู ุงูููุฉ ุงูุบุงุดูุฉ
app.post('/login', async (req, res) => {
    const { email, password } = req.body;
    
    const user = await db.findUser(email);
    if (!user) {
        return res.json({ error: 'ุจูุงูุงุช ุงูุงุนุชูุงุฏ ุบูุฑ ุตุญูุญุฉ' });
    }
    
    // ูุญุต ูููุฉ ูุฑูุฑ ุจุณูุท ุจุฏูู ุชุญุฏูุฏ ุงููุนุฏู
    if (user.password === password) {
        return res.json({ 
            success: true, 
            token: generateToken(user) 
        });
    }
    
    res.json({ error: 'Invalid credentials' });
});</pre></div></div><div class="secure-implementation"><h3><span>๐ก๏ธ ุงูุชูููุฐ ุงูุขูู</span></h3><div class="secure-code"><h4><span>โ ููุฏ ูุญูู</span></h4><pre class="code-block language-javascript">
// ุฌูุฏ: ุทุจูุงุช ูุชุนุฏุฏุฉ ูู ุงูุญูุงูุฉ ุถุฏ ูุฌูู ุงูููุฉ ุงูุบุงุดูุฉ
const rateLimit = require('express-rate-limit');
const bcrypt = require('bcrypt');

// ุชุญุฏูุฏ ุงููุนุฏู
const loginLimiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 ุฏูููุฉ
    max: 5, // 5 ูุญุงููุงุช ููู ูุงูุฐุฉ
    message: 'ูุญุงููุงุช ุชุณุฌูู ุฏุฎูู ูุซูุฑุฉ ุฌุฏุงูุ ูุฑุฌู ุงููุญุงููุฉ ูุงุญูุงู'
});

// ุชุชุจุน ููู ุงูุญุณุงุจ
const failedAttempts = new Map();

app.post('/login', loginLimiter, async (req, res) => {
    const { email, password } = req.body;
    
    // ุงูุชุญูู ูู ููู ุงูุญุณุงุจ
    const attempts = failedAttempts.get(email) || 0;
    if (attempts >= 5) {
        return res.status(429).json({ 
            error: 'ุงูุญุณุงุจ ูููู ูุคูุชุงู' 
        });
    }
    
    const user = await db.findUser(email);
    if (!user) {
        // ูุง ุชูุตุญ ุนู ูุฌูุฏ ุงููุณุชุฎุฏู
        await simulateHashDelay();
        incrementFailedAttempts(email);
        return res.json({ error: 'ุจูุงูุงุช ุงูุงุนุชูุงุฏ ุบูุฑ ุตุญูุญุฉ' });
    }
    
    // ุงุณุชุฎุฏู bcrypt ููููุงุฑูุฉ ุงูุขููุฉ ููููุงุช ุงููุฑูุฑ
    const validPassword = await bcrypt.compare(password, user.hashedPassword);
    
    if (validPassword) {
        // ุฅุนุงุฏุฉ ุชุนููู ุงููุญุงููุงุช ุงููุงุดูุฉ ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ
        failedAttempts.delete(email);
        
        // ุฅุถุงูุฉ CAPTCHA ุจุนุฏ 3 ูุญุงููุงุช ูุงุดูุฉ
        if (attempts >= 3 && !req.body.captcha) {
            return res.json({ 
                error: 'ูุฑุฌู ุฅููุงู CAPTCHA',
                requireCaptcha: true 
            });
        }
        
        return res.json({ 
            success: true, 
            token: generateToken(user) 
        });
    }
    
    incrementFailedAttempts(email);
    res.json({ error: 'Invalid credentials' });
});

// ูุธุงุฆู ูุณุงุนุฏุฉ
function incrementFailedAttempts(email) {
    const current = failedAttempts.get(email) || 0;
    failedAttempts.set(email, current + 1);
    
    // ุฅุนุงุฏุฉ ุชุนููู ุชููุงุฆู ุจุนุฏ 30 ุฏูููุฉ
    setTimeout(() => {
        failedAttempts.delete(email);
    }, 30 * 60 * 1000);
}

async function simulateHashDelay() {
    // ููุน ูุฌูุงุช ุงูุชูููุช
    await new Promise(resolve => setTimeout(resolve, 100));
}</pre></div><div class="security-measures"><h4><span>๐ ุขููุงุช ุงูุฏูุงุน</span></h4><div class="defense-grid"><div class="defense-card"><h5><span>ุชุญุฏูุฏ ุงููุนุฏู</span></h5><p><span>ุชุญุฏูุฏ ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู ููู IP/ุญุณุงุจ</span></p><code><span>ุญุฏ ุฃูุตู 5 ูุญุงููุงุช ูู 15 ุฏูููุฉ</span></code></div><div class="defense-card"><h5><span>ููู ุงูุญุณุงุจ</span></h5><p><span>ููู ูุคูุช ุจุนุฏ ุงููุญุงููุงุช ุงููุงุดูุฉ</span></p><code><span>ููู ุจุนุฏ 5 ุฅุฎูุงูุงุช</span></code></div><div class="defense-card"><h5><span>ูุงุจุชุดุง</span></h5><p><span>ูุชุทูุจ ุงูุชุญูู ุงูุจุดุฑู</span></p><code><span>ุจุนุฏ 3 ูุญุงููุงุช ูุงุดูุฉ</span></code></div><div class="defense-card"><h5><span>ูููุงุช ูุฑูุฑ ูููุฉ</span></h5><p><span>ูุฑุถ ูุชุทูุจุงุช ุงูุชุนููุฏ</span></p><code><span>12 ุญุฑู ูุญุฏ ุฃุฏููุ ุฃุญุฑู ูุฎุชูุทุฉุ ุฑููุฒ</span></code></div><div class="defense-card"><h5><span>ุงููุตุงุฏูุฉ ูุชุนุฏุฏุฉ ุงูุนูุงูู</span></h5><p><span>ูุตุงุฏูุฉ ูุชุนุฏุฏุฉ ุงูุนูุงูู</span></p><code><span>SMSุ TOTPุ ุฃู ููุงุชูุญ ุงูุฃุฌูุฒุฉ</span></code></div><div class="defense-card"><h5><span>ุงููุฑุงูุจุฉ</span></h5><p><span>ุชูุจูู ุนูู ุงูุฃููุงุท ุงููุดุจููุฉ</span></p><code><span>ุชุณุฌูู ูุชุญููู ุงููุญุงููุงุช</span></code></div></div></div></div><div class="password-policy"><h3><span>๐ก ุชูุตูุงุช ุณูุงุณุฉ ูููุงุช ุงููุฑูุฑ</span></h3><ul class="policy-list"><li><span>12 ุญุฑู ูุญุฏ ุฃุฏูู (16+ ููุถู)</span></li><li><span>ูุฒูุฌ ูู ุงูุฃุญุฑู ุงููุจูุฑุฉ ูุงูุตุบูุฑุฉ ูุงูุฃุฑูุงู ูุงูุฑููุฒ</span></li><li><span>ูุง ูููุงุช ูุงููุณ ุดุงุฆุนุฉ ุฃู ุฃููุงุท</span></li><li><span>ูุง ูุนูููุงุช ุดุฎุตูุฉ (ุฃุณูุงุกุ ุชูุงุฑูุฎ)</span></li><li><span>ูููุงุช ูุฑูุฑ ูุฑูุฏุฉ ููู ุญุณุงุจ</span></li><li><span>ุชุฏููุฑ ูููุงุช ุงููุฑูุฑ ุจุงูุชุธุงู (90 ููู)</span></li><li><span>ุงุณุชุฎุฏุงู ูุฏูุฑู ูููุงุช ุงููุฑูุฑ</span></li></ul></div></div></section><!-- Lab Progress --><div class="lab-progress"><div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div><div class="progress-steps"><div class="step-indicator active"><span>ุงูุฅุนุฏุงุฏ</span></div><div class="step-indicator"><span>ุงููุฌูู</span></div><div class="step-indicator"><span>ุงููุฌุงุญ</span></div><div class="step-indicator"><span>ุงูุฏูุงุน</span></div></div></div></main><script src="../js/lab-common.js"></script><script src="../js/lab2-bruteforce.js"></script></body></html> 