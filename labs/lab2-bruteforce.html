<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>مختبر 02: هجوم Brute Force | ورشة مهندسين المستقبل</title><link rel="stylesheet" href="../css/styles.css"><link rel="stylesheet" href="../css/animations.css"><link rel="stylesheet" href="../css/labs.css"><link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet"><!-- Arabic Fonts --><link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Tajawal:wght@400;500;700&family=Noto+Sans+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="../css/arabic-fixes.css"><style>
        /* Arabic RTL Support */
        html[lang="ar"] {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] body {
            font-family: 'Cairo', 'Tajawal', 'Noto Sans Arabic', sans-serif !important;
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .message-text,
        html[lang="ar"] .lab-description,
        html[lang="ar"] .slide-body p,
        html[lang="ar"] .hint,
        html[lang="ar"] h1, h2, h3, h4, h5, h6 {
            direction: rtl;
            text-align: right;
            unicode-bidi: embed;
        }
        
        html[lang="ar"] input[type="text"],
        html[lang="ar"] textarea {
            direction: rtl;
            text-align: right;
        }
        
        html[lang="ar"] .nav-back {
            float: right;
        }
        
        html[lang="ar"] .labs-grid,
        html[lang="ar"] .ai-labs-grid {
            direction: rtl;
        }
        
        html[lang="ar"] .quick-prompts,
        html[lang="ar"] .capability-item,
        html[lang="ar"] .option-group {
            text-align: right;
        }
        
        /* Fix button alignment for RTL */
        html[lang="ar"] .genre-buttons,
        html[lang="ar"] .setting-buttons,
        html[lang="ar"] .style-buttons {
            justify-content: flex-end;
        }
        
        /* Ensure proper Arabic text rendering */
        html[lang="ar"] * {
            font-kerning: auto;
            text-rendering: optimizeLegibility;
            -webkit-font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
            font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
        }
    </style></head><body><div class="lab-grid-bg"></div><!-- Language Toggle --><nav class="lab-nav"><a href="../cyber-home.html" class="nav-back"><span>العودة ←</span></a><h1 class="nav-title"><span>مختبر 02: هجوم <span class="english-term">Brute Force</span></span></h1><div class="lab-timer">00:00:00</div></nav><main class="lab-container"><!-- View Toggle --><div class="view-toggle"><button class="toggle-btn active" onclick="switchView('hacker')"><span class="icon">💀</span><span>عرض الهاكر</span></button><button class="toggle-btn" onclick="switchView('developer')"><span class="icon">🛡️</span><span>عرض المطور</span></button><button class="toggle-btn" onclick="switchView('quiz')"><span class="icon">📝</span><span>الأسئلة</span></button></div><!-- Lab Introduction --><section class="lab-intro"><h2 class="section-header"><span>هجوم <span class="english-term">Brute Force</span></span></h2><p class="lab-description"><span>تجرب هجمات <span class="english-term">Brute Force</span> بشكل منهجي جميع تركيبات كلمات المرور الممكنة حتى العثور على الصحيحة. 
                يوضح هذا المختبر تقنيات كسر كلمات المرور وآليات الدفاع.</span></p><div class="threat-level"><span>مستوى التهديد:</span><div class="threat-bar high"></div><span class="threat-text"><span>عالي</span></span></div></section><!-- Hacker View --><section id="hacker-view" class="view-section active"><div class="terminal-header"><span class="terminal-title"><span>طرفية الهاكر</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="hacker-content"><div class="scenario-box"><h3><span>📋 السيناريو</span></h3><p><span>لقد اكتشفت نموذج تسجيل دخول بدون تحديد معدل أو قفل الحساب. 
                        الهدف يستخدم كلمات مرور ضعيفة. حان الوقت لإطلاق هجوم <span class="english-term">Brute Force</span>!</span></p><p></span><span>اسم المستخدم المستهدف: <code>admin@company.com</code></span></p></div><div class="exploit-steps"><h3><span>🔨 هجوم <span class="english-term">Brute Force</span></span></h3><div class="step"><span class="step-number">01</span><div class="step-content"><h4><span>اختر طريقة الهجوم</span></h4><div class="attack-options"><button class="attack-btn" onclick="selectAttack('dictionary')"><span>📚 هجوم القاموس</span></button><button class="attack-btn" onclick="selectAttack('common')"><span>🔤 كلمات المرور الشائعة</span></button><button class="attack-btn" onclick="selectAttack('pattern')"><span>🎯 القائم على الأنماط</span></button></div></div></div><div class="step"><span class="step-number">02</span><div class="step-content"><h4><span>إطلاق الهجوم</span></h4><div class="brute-force-interface"><button onclick="startBruteForce()" class="cyber-btn large"><span>⚡ بدء الهجوم</span></button><div class="attack-stats"><div class="stat"><span class="label"><span>المحاولات:</span></span><span id="attempt-count">0</span></div><div class="stat"><span class="label"><span>السرعة:</span></span><span id="attack-speed">0</span>/sec
                                    </div><div class="stat"><span class="label"><span>الوقت:</span></span><span id="attack-time">00:00</span></div></div></div></div></div><div class="step"><span class="step-number">03</span><div class="step-content"><h4><span>تقدم الهجوم</span></h4><div class="password-attempts" id="password-attempts"><div class="attempts-header"><span>جاري تجربة كلمات المرور...</span></div><div class="attempts-list" id="attempts-list"></div></div><div class="success-indicator" id="success-indicator"><span class="icon">🎯</span><span>تم كسر كلمة المرور: <span id="cracked-password"></span></span></span></div></div></div></div><div class="attack-visualization"><canvas id="brute-force-canvas"></canvas></div></div></section><!-- Developer View --><section id="developer-view" class="view-section"><div class="terminal-header"><span class="terminal-title"><span>وحدة تحكم المطور</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="developer-content"><div class="vulnerability-explanation"><h3><span>🐛 تحليل الثغرة الأمنية</span></h3><p><span>يفتقر التطبيق إلى الدفاعات المناسبة ضد هجمات تخمين كلمات المرور الآلية.</span></p><div class="vulnerable-code"><h4><span>❌ كود معرض للخطر</span></h4><pre class="code-block language-javascript">
// سيء: لا توجد حماية ضد هجوم Brute Force
app.post('/login', async (req, res) => {
    const { email, password } = req.body;
    
    const user = await db.findUser(email);
    if (!user) {
        return res.json({ error: 'بيانات الاعتماد غير صحيحة' });
    }
    
    // فحص كلمة مرور بسيط بدون تحديد المعدل
    if (user.password === password) {
        return res.json({ 
            success: true, 
            token: generateToken(user) 
        });
    }
    
    res.json({ error: 'Invalid credentials' });
});</pre></div></div><div class="secure-implementation"><h3><span>🛡️ التنفيذ الآمن</span></h3><div class="secure-code"><h4><span>✅ كود محمي</span></h4><pre class="code-block language-javascript">
// جيد: طبقات متعددة من الحماية ضد هجوم Brute Force
const rateLimit = require('express-rate-limit');
const bcrypt = require('bcrypt');

// تحديد المعدل
const loginLimiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 دقيقة
    max: 5, // 5 محاولات لكل نافذة
    message: 'محاولات تسجيل دخول كثيرة جداً، يرجى المحاولة لاحقاً'
});

// تتبع قفل الحساب
const failedAttempts = new Map();

app.post('/login', loginLimiter, async (req, res) => {
    const { email, password } = req.body;
    
    // التحقق من قفل الحساب
    const attempts = failedAttempts.get(email) || 0;
    if (attempts >= 5) {
        return res.status(429).json({ 
            error: 'الحساب مقفل مؤقتاً' 
        });
    }
    
    const user = await db.findUser(email);
    if (!user) {
        // لا تفصح عن وجود المستخدم
        await simulateHashDelay();
        incrementFailedAttempts(email);
        return res.json({ error: 'بيانات الاعتماد غير صحيحة' });
    }
    
    // استخدم bcrypt للمقارنة الآمنة لكلمات المرور
    const validPassword = await bcrypt.compare(password, user.hashedPassword);
    
    if (validPassword) {
        // إعادة تعيين المحاولات الفاشلة عند تسجيل الدخول بنجاح
        failedAttempts.delete(email);
        
        // إضافة CAPTCHA بعد 3 محاولات فاشلة
        if (attempts >= 3 && !req.body.captcha) {
            return res.json({ 
                error: 'يرجى إكمال CAPTCHA',
                requireCaptcha: true 
            });
        }
        
        return res.json({ 
            success: true, 
            token: generateToken(user) 
        });
    }
    
    incrementFailedAttempts(email);
    res.json({ error: 'Invalid credentials' });
});

// وظائف مساعدة
function incrementFailedAttempts(email) {
    const current = failedAttempts.get(email) || 0;
    failedAttempts.set(email, current + 1);
    
    // إعادة تعيين تلقائي بعد 30 دقيقة
    setTimeout(() => {
        failedAttempts.delete(email);
    }, 30 * 60 * 1000);
}

async function simulateHashDelay() {
    // منع هجمات التوقيت
    await new Promise(resolve => setTimeout(resolve, 100));
}</pre></div><div class="security-measures"><h4><span>🔒 آليات الدفاع</span></h4><div class="defense-grid"><div class="defense-card"><h5><span>تحديد المعدل</span></h5><p><span>تحديد محاولات تسجيل الدخول لكل IP/حساب</span></p><code><span>حد أقصى 5 محاولات كل 15 دقيقة</span></code></div><div class="defense-card"><h5><span>قفل الحساب</span></h5><p><span>قفل مؤقت بعد المحاولات الفاشلة</span></p><code><span>قفل بعد 5 إخفاقات</span></code></div><div class="defense-card"><h5><span>كابتشا</span></h5><p><span>يتطلب التحقق البشري</span></p><code><span>بعد 3 محاولات فاشلة</span></code></div><div class="defense-card"><h5><span>كلمات مرور قوية</span></h5><p><span>فرض متطلبات التعقيد</span></p><code><span>12 حرف كحد أدنى، أحرف مختلطة، رموز</span></code></div><div class="defense-card"><h5><span>المصادقة متعددة العوامل</span></h5><p><span>مصادقة متعددة العوامل</span></p><code><span>SMS، TOTP، أو مفاتيح الأجهزة</span></code></div><div class="defense-card"><h5><span>المراقبة</span></h5><p><span>تنبيه على الأنماط المشبوهة</span></p><code><span>تسجيل وتحليل المحاولات</span></code></div></div></div></div><div class="password-policy"><h3><span>💡 توصيات سياسة كلمات المرور</span></h3><ul class="policy-list"><li><span>12 حرف كحد أدنى (16+ مفضل)</span></li><li><span>مزيج من الأحرف الكبيرة والصغيرة والأرقام والرموز</span></li><li><span>لا كلمات قاموس شائعة أو أنماط</span></li><li><span>لا معلومات شخصية (أسماء، تواريخ)</span></li><li><span>كلمات مرور فريدة لكل حساب</span></li><li><span>تدوير كلمات المرور بانتظام (90 يوم)</span></li><li><span>استخدام مديري كلمات المرور</span></li></ul></div></div></section><!-- Quiz View --><section id="quiz-view" class="view-section" style="display: none;"><div class="terminal-header"><span class="terminal-title"><span>اختبار المعرفة</span></span><div class="terminal-controls"><span class="control red"></span><span class="control yellow"></span><span class="control green"></span></div></div><div class="quiz-content"><div class="quiz-intro"><h3><span>📝 اختبر معرفتك</span></h3><p><span>أجب على الأسئلة التالية لاختبار فهمك لهجمات <span class="english-term">Brute Force</span> وطرق الدفاع ضدها.</span></p></div><div class="quiz-questions" id="quiz-questions"><div class="question-card" data-question="1"><h4><span>السؤال 1: ما هو هجوم <span class="english-term">Brute Force</span>؟</span></h4><div class="options"><label class="option"><input type="radio" name="q1" value="a"><span>هجوم يستغل ثغرة في الكود</span></label><label class="option"><input type="radio" name="q1" value="b"><span>محاولة منهجية لتخمين كلمات المرور</span></label><label class="option"><input type="radio" name="q1" value="c"><span>هجوم يستخدم الهندسة الاجتماعية</span></label><label class="option"><input type="radio" name="q1" value="d"><span>اختراق قاعدة البيانات مباشرة</span></label></div></div><div class="question-card" data-question="2"><h4><span>السؤال 2: أي من التالي يُعتبر دفاعاً فعالاً ضد هجمات <span class="english-term">Brute Force</span>؟</span></h4><div class="options"><label class="option"><input type="radio" name="q2" value="a"><span>استخدام كلمات مرور قصيرة</span></label><label class="option"><input type="radio" name="q2" value="b"><span>تحديد معدل المحاولات (Rate Limiting)</span></label><label class="option"><input type="radio" name="q2" value="c"><span>السماح بمحاولات غير محدودة</span></label><label class="option"><input type="radio" name="q2" value="d"><span>تخزين كلمات المرور بشكل مكشوف</span></label></div></div><div class="question-card" data-question="3"><h4><span>السؤال 3: كم يجب أن يكون الحد الأدنى لطول كلمة المرور القوية؟</span></h4><div class="options"><label class="option"><input type="radio" name="q3" value="a"><span>4 أحرف</span></label><label class="option"><input type="radio" name="q3" value="b"><span>8 أحرف</span></label><label class="option"><input type="radio" name="q3" value="c"><span>12 حرف أو أكثر</span></label><label class="option"><input type="radio" name="q3" value="d"><span>6 أحرف</span></label></div></div><div class="question-card" data-question="4"><h4><span>السؤال 4: ما هي <span class="english-term">CAPTCHA</span> وكيف تساعد؟</span></h4><div class="options"><label class="option"><input type="radio" name="q4" value="a"><span>نوع من التشفير</span></label><label class="option"><input type="radio" name="q4" value="b"><span>اختبار للتحقق من أن المستخدم بشري</span></label><label class="option"><input type="radio" name="q4" value="c"><span>طريقة لتخزين كلمات المرور</span></label><label class="option"><input type="radio" name="q4" value="d"><span>برنامج مكافحة فيروسات</span></label></div></div><div class="question-card" data-question="5"><h4><span>السؤال 5: ما الذي يساعد في منع هجمات <span class="english-term">Brute Force</span>؟</span></h4><div class="options"><label class="option"><input type="radio" name="q5" value="a"><span>استخدام كلمة مرور واحدة لجميع الحسابات</span></label><label class="option"><input type="radio" name="q5" value="b"><span>المصادقة متعددة العوامل (MFA)</span></label><label class="option"><input type="radio" name="q5" value="c"><span>حفظ كلمات المرور في ملف نصي</span></label><label class="option"><input type="radio" name="q5" value="d"><span>مشاركة كلمات المرور مع الزملاء</span></label></div></div></div><div class="quiz-controls"><button onclick="checkAnswers()" class="cyber-btn large"><span>✅ تحقق من الإجابات</span></button><button onclick="resetQuiz()" class="cyber-btn secondary"><span>🔄 إعادة المحاولة</span></button></div><div class="quiz-results" id="quiz-results"><div class="result-summary"><h3><span>نتائج الاختبار</span></h3><div class="score-display"><span class="score-text">النتيجة: </span><span class="score-value" id="quiz-score">0/5</span></div><div class="result-message" id="result-message"></div></div><div class="answer-review" id="answer-review"></div></div></div></section><!-- Lab Progress --><div class="lab-progress"><div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div><div class="progress-steps"><div class="step-indicator active"><span>الإعداد</span></div><div class="step-indicator"><span>الهجوم</span></div><div class="step-indicator"><span>النجاح</span></div><div class="step-indicator"><span>الدفاع</span></div></div></div></main><script src="../js/lab-common.js"></script><script src="../js/lab2-bruteforce.js"></script></body></html> 